\section{Discussion and Future work}
  A number of features can be added to our protocol for additional efficiency,
  usability and flexibility. First of all, in our current construction, each
  time a particular channel $C$ acts as a base
  channel for a new virtual channel, one more ``virtualisation layer'' is added. When
  one of its owners wants to close $C$, it has to put on-chain as many
  transactions as there are virtualisation layers. Also the timelocks associated
  with closing a virtual channel increase with the number of virtualisation
  layers of its base channels. Both these issues can be alleviated by extending
  the opening and cooperative closing subprotocol with the ability to
  cooperatively open and close multiple virtual channels in the same layer,
  either simultaneously or as an amendment to an existing virtualisation layer.

  Due to the possibility of the griefing attack discussed in
  Subsection~\ref{construction:real-world}, the range of balances a virtual
  channel can
  support is limited by the balances of neighbouring channels. We believe that
  this limitation can be lifted if the Lightning-based
  construction for the payment layer is replaced with an
  eltoo-based~\cite{eltoo} one. Since in eltoo a maliciously published
  old state can be simply re-spent by the honest latest state, the griefing
  attack is completely avoided. What is more, our protocol shares with eltoo the
  need for the \texttt{ANYPREVOUT} flag, therefore no additional
  requirements from Bitcoin would be added by this change. Lastly,
  due to the separation of intermediate layers with the payment layer in our
  pseudocode implementation (i.e.\ the distinction
  between the \textsc{ln} and the \textsc{virt} protocols), this change
  in principle needs only limited changes to our protocol.

  Furthermore, any deployment of the protocol has to explicitly handle the issue
  of transaction fees. These include miner fees for on-chain transactions and
  intermediary fees for the parties that own base channels and facilitate
  opening virtual channels. These fees should take into account the fact that
  each intermediary has quadratic storage requirements, whereas endpoints only
  need constant storage, creating an opportunity for amplification attacks. Our
  protocol is compatible with any such fee parameterization and we leave for
  future work the incentive analyses that can determine concrete values for such
  intermediary fees.

  In order to increase readability and to keep focus on the salient points of
  the construction, our protocol does not exploit a number of possible
  optimisations. These include a number of techniques employed in Lightning that
  drastically reduce storage requirements, such as storage of per-update secrets
  in $O(\log n)$
  space\footnote{\url{https://github.com/lightning/bolts/blob/master/03-transactions.md\#efficient-per-commitment-secret-storage}},
  along with a variety of possible improvements to our novel virtual
  subprotocol.

  Moreover, our need for \texttt{ANYPREVOUT} prevents our protocol from being
  deployable on Bitcoin today. Though it is a prime contender for inclusion
  in the next update, there is a slight chance it will never make it.
  Nevertheless, as mentioned before, we conjecture that a variadic virtual
  channel protocol with unlimited lifetime needs each party to store an
  exponential number of signatures if \texttt{ANYPREVOUT} is not available. We
  leave proof of this as future work.

  Last but not least, the current analysis gives no privacy guarantees for the
  protocol, as it does not employ onion packets~\cite{sphinx} like Lightning.
  Furthermore, \fchan leaks all messages to the ideal adversary therefore
  theoretically no privacy is offered at all. Nevertheless, onion packets can be
  incorporated in the current construction and intuitively our construction
  leaks less data than Lightning for the same multi-hop payments, as
  intermediaries in our case are not notified on each payment, contrary to
  multi-hop payments in Lightning. Therefore a future extension can improve the
  privacy of the construction and formally demonstrate exact privacy guarantees.

  Several possible usability upgrades are discussed in
  Appendix~\ref{sec:further-future-work}.
